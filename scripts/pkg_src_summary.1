.\"	$NetBSD$
.\"
.\" Copyright (c) 2008-2024 by Aleksey Cheusov (vle@gmx.net)
.\" Absolutely no warranty.
.\"
.\" ------------------------------------------------------------------
.de VB \" Verbatim Begin
.ft CW
.nf
.ne \\$1
..
.de VE \" Verbatim End
.ft R
.fi
..
.\" ------------------------------------------------------------------
.TH PKG_SRC_SUMMARY 1 "May 26, 2024" "" ""
.SH NAME
pkg_src_summary \- build summary information for source packages
.SH SYNOPSIS
.BI pkg_src_summary " [OPTIONS] [pkgpath1 ...]"
.br
.BI pkg_src_summary " -s [OPTIONS]"
.br
.BI pkg_src_summary " -i [OPTIONS]"
.BI pkg_src_summary " -F"
.SH DESCRIPTION
.B pkg_src_summary
builds summary information about source packages specified in
arguments or read from stdin (one package per line).  Format of this
summary information is the same as used in pkg_summary(5) built from
binary packages. List of fields (PKGNAME, PKGPATH, DEPENDS etc.) is
very similar but not fully the same.
.SH OPTIONS
.TP
.B "-h"
display help message
.TP
.BI "-f" " fields"
A list of fields (separated by space character or comma) to be generated. By
default the following fields are generated: PKGNAME, PKGPATH, DEPENDS,
BUILD_DEPENDS, CONFLICTS, HOMEPAGE, COMMENT, LICENSE, ONLYFOR, NOTFOR,
MAINTAINER, CATEGORIES, NO_BIN_ON_FTP, NO_SRC_ON_FTP,
NO_BIN_ON_CDROM, NO_SRC_ON_CDROM, ALLSRCFILES, ALLDISTFILES,
DESCRIPTION (multiline), PLIST(multiline).
The following fields are NOT generated by default: CVS_CHECKSUM,
ALLDISTFILES. ALLDISTFILES value lists distfiles with their
sizes (obtained from distinfo file) separated by colon.
ALLSRCFILES value lists distfiles with relative directory (if any)
under ${DISTDIR}.
.TP
.BI "-a" " fields"
Add the specified fields to the list of fields generated by default.
.TP
.BI "-r" " fields"
Remove the specified fields from the list of fields generated by default.
.TP
.B "-b"
Add value of variable BOOTSTRAP_DEPENDS to BUILD_DEPENDS.
.TP
.B "-t"
Add value of variable TOOL_DEPENDS to BUILD_DEPENDS.
.TP
.B "-l"
Add library dependencies (buildlink3.mk) to BUILD_DEPENDS.
.TP
.B "-p"
Use 'bmake plist' for obtaining PLIST.
.TP
.B "-d"
Generate summary for specified packages and their dependancies (DEPENDS).
.TP
.B "-D"
Generate summary for specified packages and their dependancies (BUILD_DEPENDS).
.TP
.B "-T"
Generate summary for specified packages and their dependancies (TOOL_DEPENDS).
.TP
.B "-A"
Generate summary for specified packages and all their dependancies, that is,
implies -d and -D.
.TP
.B "-m"
Generate summary for all variants of multi-variant packages
(Python {22,23,24,25}, PHP {4,5}, Apache {1.3,2,2.2} etc.).
Summary for package with default Python, PHP etc. are output before others.
.TP
.B "-M"
Implies -m and moves/adds ASSIGNMENTS field to PKGPATH.
.TP
.B "-u"
Leave only one package per PKGNAME. This option is helpful in
combination with
.I -m
for excluding non-default multi-variant packages, for example,
textproc/csvtomd or devel/subversion.
.TP
.B "-i"
Generate src_summary for the installed packages only,
do not read list of packages from stdin and from pkgpathN arguments.
.TP
.B "-F"
Output fields to generate (one per line) and exit.
.TP
.B "-v"
Verbose output.
.SH ENVIRONMENT
.TP
.B PKGSRCDIR
pkgsrc root directory
.TP
.B BMAKE
path to pkgsrc friendly make utility
.TP
.B PSS_ENVIRON
List of environment variable assignments passed to slaves when
.IR PSS_TRANSPORT " and " PSS_SLAVES " are set ."
.TP
.B PSS_SLAVES
Space separated list of remote hosts or +<Number> for distributed
summary generation. If case of +<Number>, <Number> local processes
are run, this is useful for SMP machines.
.TP
.B PSS_TRANSPORT
Transport program like ssh or rsh to communicate with remote/slave hosts.
.TP
.B PSS_OPTIONS
This variable specifies default options to be placed in front of
any explicit options.
.TP
.B PSS_PAEXEC_EXTRA_OPTS
Additional options passed to
.I paexec
executable in case a pkg_summary is built in parallel. Example: -Z300
.TP
.BR PSS_PRE_PATH ", " PSS_POST_PATH
In a distributed mode prepand and append PSS_PRE_PATH and PSS_POST_PATH to
PATH
.TP
.BR MAKECONF
If MAKECONF and PSS_SLAVES are not empty, MAKECONF is passed to
.I pkg_src_summary
processes running on slave hosts.
.SH EXAMPLES
.VB
pkg_src_summary wip/dict-server wip/dict-mueller7 wip/dict-client
printf 'wip/dict-server\\nwip/dict-client\\n' | pkg_src_summary
env BMAKE=/usr/bin/make \\
   PSS_ENVIRON='LD_PRELOAD=/usr/pkg/lib/libkver.so LIBKVER_OSRELEASE=10.0 \\'
   PSS_SLAVES='host1 host2' \\ 
   PSS_TRANSPORT=/usr/bin/ssh \\ 
   /usr/pkg/bin/pkg_src_summary \\ 
          -f 'PKGNAME PKGPATH DEPENDS BUILD_DEPENDS' \\ 
          < /tmp/packages.txt \\ 
pkg_list_all_pkgs | env PSS_SLAVES='+6' pkg_src_summary
env PSS_OPTIONS=-p pkg_update_src_summary /path/to/pkg_src_summary.txt
pkg_src_summary -a CVS_CHECKSUM x11/xxkb wip/distbb
pkg_src_summary -r LICENSE,PLIST,DESCR x11/xxkb wip/distbb
pkg_src_summary -m lang/lua www/php-apc www/ap2-python
pkg_src_summary -i
pkg_src_summary -l -b textproc/dict-server
pkg_src_summary -mu -rPLIST textproc/csvtomd devel/py-test
.VE
.SH ENVIRONMENT
.TP
.B TMPDIR
Directory for temporary files, by default
.I /tmp
is used.
.SH SEE ALSO
.BR pkg_summary-utils(7) ,
.B pkg_summary(5)
.SH AUTHOR
Aleksey Cheusov <vle@gmx.net>
